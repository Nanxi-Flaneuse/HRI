Integrating some of Emily's collision event handling, used some CGPT.
